{"version":3,"file":"auth-strategy.js","sourceRoot":"","sources":["../../../../.ng_build/auth/strategies/auth-strategy.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,YAAY,EAAE,MAAM,sBAAsB,CAAC;AAIpD,OAAO,EAAE,UAAU,EAAE,iBAAiB,EAAE,MAAM,YAAY,CAAC;AAC3D,OAAO,EAEL,iBAAiB,EACjB,uBAAuB,GACxB,MAAM,yBAAyB,CAAC;AAEjC;IAAA;IAwDA,CAAC;IAnDC,qFAAqF;IACrF,yDAAyD;IACzD,mCAAU,GAAV,UAAW,OAAY;QACrB,IAAI,CAAC,OAAO,GAAG,UAAU,CAAC,EAAE,EAAE,IAAI,CAAC,cAAc,EAAE,OAAO,CAAC,CAAC;IAC9D,CAAC;IAED,kCAAS,GAAT,UAAU,GAAW;QACnB,OAAO,iBAAiB,CAAC,IAAI,CAAC,OAAO,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;IACpD,CAAC;IAED,oCAAW,GAAX,UAAmC,KAAU,EAAE,oBAA8B;QAC3E,IAAM,KAAK,GAAI,iBAAiB,CAAI,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,EAAE,KAAK,EAAE,IAAI,CAAC,OAAO,EAAE,CAAC,CAAC;QAC1F,+GAA+G;QAC/G,6GAA6G;QAC7G,IAAI,oBAAoB,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,EAAE;YAC5C,gHAAgH;YAChH,eAAe;YACf,MAAM,IAAI,uBAAuB,CAAC,4BAA4B,CAAC,CAAC;SACjE;QACD,OAAO,KAAK,CAAC;IACf,CAAC;IAED,gCAAO,GAAP;QACE,OAAO,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;IAChC,CAAC;IAcS,2CAAkB,GAA5B,UAA6B,IAAU;QACrC,OAAO,IAAI,YAAY,CAAS,EAAE,IAAI,EAAE,EAAE,EAAE,MAAM,EAAE,GAAG,EAAE,CAAC,CAAC;IAC7D,CAAC;IAES,8CAAqB,GAA/B,UAAgC,IAAU;QACxC,OAAO,IAAI,YAAY,CAAS,EAAE,IAAI,EAAE,EAAE,EAAE,MAAM,EAAE,GAAG,EAAE,CAAC,CAAC;IAC7D,CAAC;IAES,0CAAiB,GAA3B,UAA4B,MAAc;QACxC,IAAM,cAAc,GAAW,IAAI,CAAC,SAAS,CAAI,MAAM,cAAW,CAAC,CAAC;QACpE,IAAM,YAAY,GAAW,IAAI,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;QAC5D,OAAO,YAAY,GAAG,cAAc,CAAC;IACvC,CAAC;IACH,qBAAC;AAAD,CAAC,AAxDD,IAwDC","sourcesContent":["import { HttpResponse } from '@angular/common/http';\nimport { Observable } from 'rxjs';\nimport { NbAuthResult } from '../services/auth-result';\nimport { NbAuthStrategyOptions } from './auth-strategy-options';\nimport { deepExtend, getDeepFromObject } from '../helpers';\nimport {\n  NbAuthToken,\n  nbAuthCreateToken,\n  NbAuthIllegalTokenError,\n} from '../services/token/token';\n\nexport abstract class NbAuthStrategy {\n\n  protected defaultOptions: NbAuthStrategyOptions;\n  protected options: NbAuthStrategyOptions;\n\n  // we should keep this any and validation should be done in `register` method instead\n  // otherwise it won't be possible to pass an empty object\n  setOptions(options: any): void {\n    this.options = deepExtend({}, this.defaultOptions, options);\n  }\n\n  getOption(key: string): any {\n    return getDeepFromObject(this.options, key, null);\n  }\n\n  createToken<T extends NbAuthToken>(value: any, failWhenInvalidToken?: boolean): T {\n    const token =  nbAuthCreateToken<T>(this.getOption('token.class'), value, this.getName());\n    // At this point, nbAuthCreateToken failed with NbAuthIllegalTokenError which MUST be intercepted by strategies\n    // Or token is created. It MAY be created even if backend did not return any token, in this case it is !Valid\n    if (failWhenInvalidToken && !token.isValid()) {\n      // If we require a valid token (i.e. isValid), then we MUST throw NbAuthIllegalTokenError so that the strategies\n      // intercept it\n      throw new NbAuthIllegalTokenError('Token is empty or invalid.');\n    }\n    return token;\n  }\n\n  getName(): string {\n    return this.getOption('name');\n  }\n\n  abstract authenticate(data?: any): Observable<NbAuthResult>;\n\n  abstract register(data?: any): Observable<NbAuthResult>;\n\n  abstract requestPassword(data?: any): Observable<NbAuthResult>;\n\n  abstract resetPassword(data?: any): Observable<NbAuthResult>;\n\n  abstract logout(): Observable<NbAuthResult>;\n\n  abstract refreshToken(data?: any): Observable<NbAuthResult>;\n\n  protected createFailResponse(data?: any): HttpResponse<Object> {\n    return new HttpResponse<Object>({ body: {}, status: 401 });\n  }\n\n  protected createSuccessResponse(data?: any): HttpResponse<Object> {\n    return new HttpResponse<Object>({ body: {}, status: 200 });\n  }\n\n  protected getActionEndpoint(action: string): string {\n    const actionEndpoint: string = this.getOption(`${action}.endpoint`);\n    const baseEndpoint: string = this.getOption('baseEndpoint');\n    return baseEndpoint + actionEndpoint;\n  }\n}\n"]}